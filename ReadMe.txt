Тестовый проект для короткой демонстрации работы с сервисами при помощи контейнера из Symfony/DependencyInjection.
Все сервисы лежат в src/My/Task/Service, там же и лежат конфиги с их объявлением (_config).

В проекте подразумевается, что в зависимости от окружения могут использоваться разные имплементации.
Здесь реализованы разные имплементации для сервисом отправки сообщений (почта и просто в файл),
и БД (просто классы-заглушки).

В синглтоне приложения должно определяться, какие конфиги грузить, в зависимости от окружения.
В данном примере эту функцию выполняет константа DEV_ENV, которая устанавливается в тестовом bootstrap.php

Данное решение имеет исключительно черновой характер, для демонстрации принципа, однако тест MailServiceTest работает.

При таком подходе получается, что сервисы определяются специальными идентификаторами (app.mail_sender),
а не названиями классов. В таком случае в зависимости от окружения, можно легко подменять классы,
не изменяя не строчки кода. Что весьма удобно.

Важно следить, чтобы все классы, которые могут быть загружены под идентификатором сервиса действительно могли
предоставить все функции, которые должны. Для этого можно использовать интерфейсы (как в данном примере)
или например наследование.